generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Puzzle {
  id         String  @id @default(cuid())
  day        Int     @unique // UTC day index
  puzzleId   String  // public id for the day
  title      String
  content    String  // clue text
  imageUrl   String?
  hints      String  // JSON array of hint strings
  puzzleType String  @default("riddle") // riddle, cipher, pattern, image
  difficulty String  @default("medium") // easy, medium, hard
  answer     String  @default("") // the correct answer (hashed for comparison)
  bonusMultiplier Float @default(1.0) // extra points for harder puzzles
  createdAt  DateTime @default(now())
}

model HintRequest {
  id     String @id @default(cuid())
  wallet String
  day    Int
  count  Int     @default(0)
  updatedAt DateTime @updatedAt

  @@unique([wallet, day])
}

model Referral {
  id        String   @id @default(cuid())
  referrer  String   // wallet address of referrer
  referee   String   @unique // wallet address of new user
  createdAt DateTime @default(now())

  @@index([referrer])
}

model Player {
  id            String   @id @default(cuid())
  wallet        String   @unique
  referralCode  String   @unique @default(cuid())
  referralCount Int      @default(0)
  bonusPoints   Int      @default(0)
  fid           Int?     // Farcaster ID for notifications
  notifyDaily   Boolean  @default(false)
  notifyStreak  Boolean  @default(false)
  createdAt     DateTime @default(now())
}
